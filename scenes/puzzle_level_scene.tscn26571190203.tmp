[gd_scene load_steps=51 format=3 uid="uid://dharp37746f5j"]

[ext_resource type="Script" uid="uid://73pkmj273qjj" path="res://scripts/puzzle_level_scene.gd" id="1_wvkbx"]
[ext_resource type="PackedScene" uid="uid://bx0u14bty8rqm" path="res://scenes/polyphonic_audio_player.tscn" id="4_qpt1g"]
[ext_resource type="Script" uid="uid://b0t3mmdcvowi7" path="res://scripts/classes/audio_library.gd" id="5_dagly"]
[ext_resource type="Script" uid="uid://cc0uc0xkw2lqg" path="res://scripts/puzzle_mode.gd" id="5_vvsg7"]
[ext_resource type="Script" uid="uid://cnaxqhjw0cjm5" path="res://scripts/sequencer.gd" id="6_e03pu"]
[ext_resource type="Script" uid="uid://xwsen5j60ci3" path="res://scripts/classes/sound_effect.gd" id="6_nq7dn"]
[ext_resource type="AudioStream" uid="uid://dnpr767ls1pn5" path="res://assets/audio/samples/instr1/dmajor/0-d3.wav" id="7_4a5u3"]
[ext_resource type="Script" uid="uid://kua02r6f4624" path="res://scripts/classes/ui/puzzle_mode_ui.gd" id="7_mvy5p"]
[ext_resource type="LabelSettings" uid="uid://caif6pkqts43m" path="res://assets/LabelSettings_Default.tres" id="8_ib56u"]
[ext_resource type="AudioStream" uid="uid://cnktxvobn2sm2" path="res://assets/audio/samples/instr1/dmajor/1-e3.wav" id="8_qv4qn"]
[ext_resource type="Texture2D" uid="uid://do8ov7ffsws14" path="res://assets/rgb_gradient.tres" id="9_qpt1g"]
[ext_resource type="AudioStream" uid="uid://bjcfj5t2qmdjw" path="res://assets/audio/samples/instr1/dmajor/2-f#3.wav" id="9_vjcl8"]
[ext_resource type="Script" uid="uid://hd1dahd1lpfr" path="res://scripts/classes/confetti_emitter.gd" id="10_dagly"]
[ext_resource type="AudioStream" uid="uid://diamtogqammt2" path="res://assets/audio/samples/instr1/dmajor/3-g3.wav" id="10_fjy6q"]
[ext_resource type="AudioStream" uid="uid://rm70bsuf4rkh" path="res://assets/audio/samples/instr1/dmajor/4-a4.wav" id="11_6q0g5"]
[ext_resource type="AudioStream" uid="uid://bue8pc0gceqel" path="res://assets/audio/samples/instr1/dmajor/5-b4.wav" id="12_io0to"]
[ext_resource type="AudioStream" uid="uid://cej544e72jck8" path="res://assets/audio/samples/instr1/dmajor/6-c#4.wav" id="13_q8fmo"]
[ext_resource type="AudioStream" uid="uid://b67v3q03lg568" path="res://assets/audio/samples/instr1/dmajor/7-d4.wav" id="14_68n2j"]
[ext_resource type="AudioStream" uid="uid://m83r3ogjibli" path="res://assets/audio/samples/instr2/dmajor/0-d4.wav" id="15_io0to"]
[ext_resource type="AudioStream" uid="uid://bf8aqyilqxwkl" path="res://assets/audio/samples/instr2/dmajor/1-e4.wav" id="16_q8fmo"]
[ext_resource type="AudioStream" uid="uid://cey8pgot445fq" path="res://assets/audio/samples/instr2/dmajor/2-f#4.wav" id="17_68n2j"]
[ext_resource type="AudioStream" uid="uid://c550bubxeyn3o" path="res://assets/audio/samples/instr2/dmajor/3-g4.wav" id="18_dwanr"]
[ext_resource type="AudioStream" uid="uid://dyafr5yn7wnx3" path="res://assets/audio/samples/instr2/dmajor/4-a5.wav" id="19_yw4a1"]
[ext_resource type="AudioStream" uid="uid://cgwcsrlsv0k3n" path="res://assets/audio/samples/instr2/dmajor/5-b5.wav" id="20_ghf5v"]
[ext_resource type="AudioStream" uid="uid://beiy46enjvtip" path="res://assets/audio/samples/instr2/dmajor/6-c#5.wav" id="21_lqad8"]
[ext_resource type="AudioStream" uid="uid://x4re3tv34v16" path="res://assets/audio/samples/instr2/dmajor/7-d5.wav" id="22_ah7th"]

[sub_resource type="Resource" id="Resource_dwanr"]
script = ExtResource("6_nq7dn")
tag = "0_0"
stream = ExtResource("7_4a5u3")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_yw4a1"]
script = ExtResource("6_nq7dn")
tag = "0_1"
stream = ExtResource("8_qv4qn")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_ghf5v"]
script = ExtResource("6_nq7dn")
tag = "0_2"
stream = ExtResource("9_vjcl8")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_lqad8"]
script = ExtResource("6_nq7dn")
tag = "0_3"
stream = ExtResource("10_fjy6q")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_ah7th"]
script = ExtResource("6_nq7dn")
tag = "0_4"
stream = ExtResource("11_6q0g5")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_tminp"]
script = ExtResource("6_nq7dn")
tag = "0_5"
stream = ExtResource("12_io0to")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_lnjkg"]
script = ExtResource("6_nq7dn")
tag = "0_6"
stream = ExtResource("13_q8fmo")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_gbyfo"]
script = ExtResource("6_nq7dn")
tag = "0_7"
stream = ExtResource("14_68n2j")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_ri14p"]
script = ExtResource("5_dagly")
sound_effects = Array[ExtResource("6_nq7dn")]([SubResource("Resource_dwanr"), SubResource("Resource_yw4a1"), SubResource("Resource_ghf5v"), SubResource("Resource_lqad8"), SubResource("Resource_ah7th"), SubResource("Resource_tminp"), SubResource("Resource_lnjkg"), SubResource("Resource_gbyfo")])
metadata/_custom_type_script = "uid://b0t3mmdcvowi7"

[sub_resource type="Resource" id="Resource_uo2j7"]
script = ExtResource("6_nq7dn")
tag = "1_0"
stream = ExtResource("15_io0to")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_s1a1d"]
script = ExtResource("6_nq7dn")
tag = "1_1"
stream = ExtResource("16_q8fmo")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_ctamp"]
script = ExtResource("6_nq7dn")
tag = "1_2"
stream = ExtResource("17_68n2j")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_5r12w"]
script = ExtResource("6_nq7dn")
tag = "1_3"
stream = ExtResource("18_dwanr")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_fjfys"]
script = ExtResource("6_nq7dn")
tag = "1_4"
stream = ExtResource("19_yw4a1")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_a3uvh"]
script = ExtResource("6_nq7dn")
tag = "1_5"
stream = ExtResource("20_ghf5v")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_d8lxh"]
script = ExtResource("6_nq7dn")
tag = "1_6"
stream = ExtResource("21_lqad8")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_6rvxu"]
script = ExtResource("6_nq7dn")
tag = "1_7"
stream = ExtResource("22_ah7th")
metadata/_custom_type_script = "uid://xwsen5j60ci3"

[sub_resource type="Resource" id="Resource_0xmo0"]
script = ExtResource("5_dagly")
sound_effects = Array[ExtResource("6_nq7dn")]([SubResource("Resource_uo2j7"), SubResource("Resource_s1a1d"), SubResource("Resource_ctamp"), SubResource("Resource_5r12w"), SubResource("Resource_fjfys"), SubResource("Resource_a3uvh"), SubResource("Resource_d8lxh"), SubResource("Resource_6rvxu")])
metadata/_custom_type_script = "uid://b0t3mmdcvowi7"

[sub_resource type="LabelSettings" id="LabelSettings_nnehw"]
font_size = 15
font_color = Color(0.830335, 0.830335, 0.830335, 1)
outline_size = 1
outline_color = Color(0, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_kal5q"]
font_size = 36
outline_size = 6
outline_color = Color(0, 0, 0, 1)

[sub_resource type="CurveTexture" id="CurveTexture_ym1n0"]

[sub_resource type="Curve" id="Curve_kal5q"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_wvkbx"]
curve = SubResource("Curve_kal5q")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_kal5q"]
particle_flag_disable_z = true
emission_shape = 3
emission_box_extents = Vector3(1000, 0, 0)
angle_min = -180.0
angle_max = 180.0
direction = Vector3(0, -1, 0)
spread = 180.0
initial_velocity_min = 199.5
initial_velocity_max = 200.5
angular_velocity_min = 99.0
angular_velocity_max = 101.0
radial_velocity_min = -180.0
radial_velocity_max = 180.0
radial_velocity_curve = SubResource("CurveTexture_ym1n0")
gravity = Vector3(0, 500, 0)
scale_min = 3.0
scale_max = 5.0
scale_curve = SubResource("CurveTexture_wvkbx")
color_initial_ramp = ExtResource("9_qpt1g")

[node name="PuzzleLevel" type="Node2D"]
script = ExtResource("1_wvkbx")

[node name="PuzzleMode" type="Node" parent="."]
script = ExtResource("5_vvsg7")

[node name="Sequencer" type="Node2D" parent="."]
script = ExtResource("6_e03pu")

[node name="instr1_PolyphonicAudioPlayer" parent="Sequencer" instance=ExtResource("4_qpt1g")]
audio_library = SubResource("Resource_ri14p")

[node name="instr2_PolyphonicAudioPlayer" parent="Sequencer" instance=ExtResource("4_qpt1g")]
audio_library = SubResource("Resource_0xmo0")

[node name="PuzzleUI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
script = ExtResource("7_mvy5p")

[node name="LevelNameLabel" type="Label" parent="PuzzleUI"]
layout_mode = 0
offset_left = 1.0
offset_right = 88.0
offset_bottom = 23.0
text = "LevelName"
label_settings = ExtResource("8_ib56u")

[node name="LevelDescriptionLabel" type="Label" parent="PuzzleUI"]
layout_mode = 0
offset_left = 1.0
offset_top = 23.0
offset_right = 130.0
offset_bottom = 46.0
text = "LevelDescription"
label_settings = SubResource("LabelSettings_nnehw")

[node name="CurrentScoreLabel" type="Label" parent="PuzzleUI"]
layout_mode = 1
offset_top = 46.0
offset_right = 61.0
offset_bottom = 69.0
text = "Score: 0"
label_settings = ExtResource("8_ib56u")

[node name="TotalScoreLabel" type="Label" parent="PuzzleUI"]
layout_mode = 0
offset_top = 69.0
offset_right = 104.0
offset_bottom = 92.0
text = "Total Score: 0"
label_settings = ExtResource("8_ib56u")

[node name="ControlsLabel" type="Label" parent="PuzzleUI"]
layout_mode = 0
offset_left = 1.0
offset_top = 92.0
offset_right = 257.0
offset_bottom = 349.0
text = "Controls
-------------
↔ (Move cursor)
↕ (Change note)
A (Play goal pattern)
S  (Check goal pattern)
Z (Activate note)
X (Pause/Play)
C (Stop)
Enter (Next Level, on Win Screen)"
label_settings = ExtResource("8_ib56u")

[node name="WinOrLoseLabel" type="Label" parent="PuzzleUI"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 427.0
offset_top = 248.0
offset_right = 697.0
offset_bottom = 298.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(60.5, 11.5)
text = "YOU WIN/LOSE!"
label_settings = SubResource("LabelSettings_kal5q")
horizontal_alignment = 1
vertical_alignment = 1
uppercase = true

[node name="ConfettiEmitter" type="GPUParticles2D" parent="."]
position = Vector2(564, 151)
emitting = false
amount = 500
lifetime = 2.0
explosiveness = 0.8
randomness = 1.0
fixed_fps = 12
process_material = SubResource("ParticleProcessMaterial_kal5q")
script = ExtResource("10_dagly")

[connection signal="level_state_request_change" from="PuzzleMode" to="." method="_on_puzzle_mode_level_state_request_change"]
